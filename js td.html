<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>ToDo List Persistante</title>
</head>
<body>

  <h1>Ma ToDo List</h1>

  <input type="text" id="todo-input" placeholder="Nouvelle tâche..." />
  <button id="add-btn">Ajouter</button>

  <ul id="todo-list"></ul>

  <script>
  // Sélection des éléments HTML
    const form = document.getElementById('taskForm');
    const input = document.getElementById('taskInput');
    const select = document.getElementById('categorySelect');

    // Chargement des tâches depuis le localStorage ou tableau vide
    let tasks = JSON.parse(localStorage.getItem('tasks')) || [];

    // 🔐 Fonction pour sauvegarder dans localStorage
    function saveTasks() {
      localStorage.setItem('tasks', JSON.stringify(tasks));
    }

    // 🔄 Fonction d’affichage des tâches dans chaque catégorie
    function renderTasks() {
      // Boucle sur chaque catégorie
      ['a-faire', 'en-cours', 'termine'].forEach(cat => {
        const container = document.querySelector(`#${cat} .task-list`);
        container.innerHTML = ''; // vide la section avant de la remplir

        // Filtrer les tâches selon la catégorie actuelle
        tasks.filter(t => t.category === cat).forEach(task => {
          // Crée le bloc de la tâche
          const taskEl = document.createElement('div');
          taskEl.className = 'task' + (task.done ? ' done' : '');

          const span = document.createElement('span');
          span.textContent = task.text;

          // Création du conteneur pour les boutons
          const btnContainer = document.createElement('div');
          btnContainer.className = 'task-buttons';

          // ✔ Bouton de validation
          const doneBtn = document.createElement('button');
          doneBtn.className = 'done-btn';
          doneBtn.textContent = '✔';
          doneBtn.onclick = () => {
            task.done = !task.done; // inverse le statut terminé
            saveTasks();
            renderTasks(); // rafraîchit l’affichage
          };

          // 🗑 Bouton de suppression
          const deleteBtn = document.createElement('button');
          deleteBtn.className = 'delete-btn';
          deleteBtn.textContent = '🗑';
          deleteBtn.onclick = () => {
            tasks = tasks.filter(t => t.id !== task.id); // supprime du tableau
            saveTasks();
            renderTasks();
          };

          // Ajoute les boutons
          btnContainer.appendChild(doneBtn);
          btnContainer.appendChild(deleteBtn);

          // Assemble la tâche
          taskEl.appendChild(span);
          taskEl.appendChild(btnContainer);
          container.appendChild(taskEl);
        });
      });
    }

    // 📤 Soumission du formulaire
    form.addEventListener('submit', function(e) {
      e.preventDefault(); // empêche le rechargement
      const text = input.value.trim(); // récupère et nettoie le texte
      const category = select.value;

      if (text !== '') {
        const newTask = {
          id: Date.now(), // identifiant unique basé sur le temps
          text,
          category,
          done: false
        };
        tasks.push(newTask); // ajoute la tâche au tableau
        saveTasks();         // sauvegarde dans localStorage
        renderTasks();       // actualise l’affichage
        input.value = '';    // vide le champ texte
      }
    });

    // 🚀 Affichage initial
    renderTasks();

  
  </script>
</body>
</html>